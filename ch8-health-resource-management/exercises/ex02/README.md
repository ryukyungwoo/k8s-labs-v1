# 실습 2: 서비스 받을 준비, 끝났니? (Readiness Probe)

### 🎯 학습 목표
1. Pod의 컨테이너가 시작되자마자 트래픽을 전송했을 때 발생하는 문제점을 이해한다.
2. `readinessProbe`를 사용하여 애플리케이션이 완전히 준비될 때까지 트래픽을 차단하고, 무중단 롤링 업데이트를 구현하는 방법을 배운다.

### 📜 실습 시나리오
1.  **시작하는 데 15초가 걸리는** 웹 서버를 만든다. (DB 연결, 캐시 로딩 등 초기화 작업 시뮬레이션)
2.  **Probe가 없는 Deployment**를 배포하고 Service와 연결한다.
    - Pod는 `Running` 상태가 되자마자 `READY` 상태(`1/1`)가 되고, Service는 즉시 트래픽을 보낸다.
    - 사용자는 처음 15초 동안 `Connection Refused` 에러를 겪는다.
3.  **readinessProbe가 있는 Deployment**를 다시 배포한다.
    - Pod가 `Running`이 되어도, `readinessProbe`가 성공하기 전까지는 `READY` 상태가 `0/1`으로 유지된다.
    - Service는 `READY` 상태가 `1/1`이 될 때까지 기다렸다가 트래픽을 보내므로, 사용자는 에러를 겪지 않는다.
4.  **롤링 업데이트**를 진행하며, `readinessProbe` 덕분에 서비스 중단 없이 안전하게 업데이트가 완료되는 것을 확인한다.

### ✅ 확인 포인트
- Probe가 없을 때: `curl` 루프 실행 시 초반에 대량의 연결 거부 에러 발생.
- Probe가 있을 때: `kubectl get pod -w` 실행 시 `READY` 상태가 `0/1` -> `1/1`로 바뀌는 것을 관찰. `curl` 루프에서는 단 하나의 에러도 발생하지 않음.